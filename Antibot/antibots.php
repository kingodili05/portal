<?php
 goto ybiLI; W52vq: $client_domain = $_SERVER["\123\x45\122\x56\x45\122\x5f\116\x41\115\x45"]; goto GrCus; ybiLI: if (session_status() == PHP_SESSION_NONE) { session_start(); } goto Z1o0T; paROk: $tokens = json_decode($token_data, true)["\x74\x6f\153\x65\156\163"]; goto f2wtM; QHPiG: $token_url = $config["\x73\145\162\166\145\x72\137\x65\156\x64\x70\157\151\x6e\x74"]; goto W52vq; z_FQI: $client_token = $config["\164\x6f\x6b\x65\x6e"]; goto QHPiG; Qzrxy: if ($client_domain === "\154\157\x63\141\x6c\x68\x6f\163\x74" || $client_domain === "\61\x32\67\x2e\60\56\x30\56\x31") { if (validate_token($client_token, $tokens)) { $_SESSION["\x61\165\164\x68\145\156\x74\x69\x63\141\164\145\x64"] = true; } else { http_response_code(403); die("\x34\x30\x33\x20\x46\157\x72\x62\x69\x64\x64\x65\156\x21\x20\111\x6e\166\141\154\151\144\40\164\x6f\153\x65\x6e\56"); } } else { $is_valid = false; foreach ($tokens as $entry) { if ($entry["\x74\157\153\x65\x6e"] === $client_token && $entry["\x77\x65\142\163\x69\x74\x65"] === $client_domain) { $is_valid = true; break; } } if ($is_valid) { $_SESSION["\x61\x75\x74\x68\x65\x6e\x74\x69\x63\x61\164\x65\144"] = true; } else { http_response_code(403); die("\64\60\63\40\x46\x6f\x72\142\x69\144\x64\x65\156\41\x20\x49\156\166\x61\x6c\151\x64\40\164\157\153\145\x6e\40\157\162\x20\x64\x6f\155\x61\x69\156\56"); } } goto tK1bw; Z1o0T: $config = (include "\143\x6f\156\146\151\147\56\x70\x68\x70"); goto z_FQI; f2wtM: if (!function_exists("\x76\x61\154\151\x64\141\x74\x65\x5f\164\x6f\153\x65\156")) { function validate_token($client_token, $tokens) { foreach ($tokens as $entry) { if ($entry["\164\x6f\x6b\x65\156"] === $client_token) { return true; } } return false; } } goto Qzrxy; GrCus: $token_data = file_get_contents($token_url); goto paROk; tK1bw: ?>